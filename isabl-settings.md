# Isabl Settings

Each component of Isabl can be configured in multiple ways. Generally, settings are strings, numbers, objects, and many other types. 

{% hint style="info" %}
**`Import Strings`** point to an _importable_ object, whether its a class, a function, etc. \(e.g.`isabl_cli.data.DataImporter`\)
{% endhint %}

## Database Managed Settings

Some Isabl API, Isabl Web, and Isabl CLI and be configured from the admin site! To do so, go to `/admin/isabl_api/client/` and update the clients called `default-backend-settings` for Isabl API, and `default-frontend-settings` for Isabl Web. You may want to create your own client for Isabl CLI \(see [Writing Applications](writing-applications.md)\).

## Isabl API Settings

Here is a detailed list of available configurations for Isabl API. To configure Isabl API, add a dictionary called `ISABL_SETTINGS` to your Django configuration. 

| Setting Name | Type | Description |
| :--- | :--- | :--- |
| **EXTRA\_GENDERS** | _List_ | `Individual genders` as two-value tuples \(value, verbose name\). |
| **EXTRA\_STATUS** | _List_  | `Analysis status` as two-value tuples \(value, verbose name\). |
| **EXTRA\_RAW\_DATA\_FORMATS** | _List_ | Experiment `raw_data` formats. Learn how to support extra formats  [here](import-data.md#supported-data-formats). |
| **EXTRA\_SPECIES** | _List_ | Individual `species` as three-value tuples \(value, verbose name, system\_id modifier\). For example: `[("YEAST", "YEAST", "Y")]` |
| **EXTRA\_SAMPLE\_CATEGORIES** | _List_ | Sample `categories` as three-value tuples \(value, verbose name, system\_id modifier\). For example`[("UNKNOWN", "UNKNOWN", "U")]` |
| **EXTRA\_TECHNIQUE\_METHODS** | _List_ | Technique `methods`as three-value tuples \(value, verbose name, system\_id modifier\). For example:`[("SINGLE-CELL RNA", "SINGLE-CELL RNA", "scRNA")]` |
| **API\_V1\_EXTRA\_PATTERNS** | _Import String_ | Import path to a list of [`urlpatterns`](https://docs.djangoproject.com/en/2.2/ref/urls/)to append to API v1. |
| **SYSTEM\_ID\_PREFIX** | _String_ | A prefix for the default sample ID generated by Isabl \(with the hope to differentiate objects across Isabl instances\). ****For example, if set to `DEMO`, then experiments might be named `DEMO_H000002_T01_01_TD01`. |
| **SYSTEM\_ID\_GENERATOR** | _Import String_ | Import path to a function that takes either an `Individual`, `Sample`, `Aliquot`, or `Experiment` and returns a system identifier. This will overwrite the default generation of system ids \(e.g. `DEMO_H000002_T01_01_TD01`\). |
| **FRONTEND\_URL** | _String_ | URL where the frontend is being deployed \(not required if frontend running in same host as backend\). |
| **JIRA\_SETTINGS** | _Dictionary_ | Experimental feature to integrate JIRA with Isabl projects \(It can assign a different JIRA epic to each Isabl Group\). |
| **REQUIRE\_ACCOUNT\_APPROVAL** | _Boolean_ | Disable new accounts and send out email to admins to require approval before new users can login. |

Learn more about production deployment:

{% page-ref page="production-deployment.md" %}

## Isabl CLI Settings

Before anything, you must set the following environment variables:

```bash
# you need to let Isabl CLI where the API is being hosted
export ISABL_API_URL='your-isabl-instance.org/api/v1/'

# you can create a client object in from the django admin
export ISABL_CLIENT_ID=<insert-client-primary-key-or-slug>
```

Once this is set, you can configure your client object settings with the following configurations \(see [**`isabl_cli.settings`**](https://github.com/isabl-io/cli/blob/master/isabl_cli/settings.py#L20) to check default settings\):

| Setting Name | Type | Description |
| :--- | :--- | :--- |
| **API\_BASE\_URL** | _String_ | url host where your isabl api is running. Needed to connect the CLI with the API. |
| **BASE\_STORAGE\_DIRECTORY** | _String_ | Directory where data will be store in the file system. |
| **TIME\_ZONE** | _String_ | Current timezone used by `pytz` package. |
| **INSTALLED\_APPLICATIONS** | _Import Strings Array_ | Array of registered applications to be run with the cli tool. These apps can be seen and run `isabl apps --help`. |
| **CUSTOM\_COMMANDS** | _Import Strings Array_ | Array of custom commands to be added to the custom cli tool. |
| **SYSTEM\_COMMANDS** | _Import Strings Array_ | Array of system commands that are used in isabl-cli. |
| **ADMIN\_COMMANDS** | _Import Strings Array_ | Array of commands that are only executable by admin. |
| **ADMIN\_USER** | _String_ | Linux user for which admin operations will be limited. This user will own the data and analyses results. Nevertheless, Isabl Applications can be run by multiple unix users. Learn more about it [here](writing-applications.md#applications-run-by-multiple-users). |
| **CREATE\_SYMLINKS** | _Boolean_ | By default, Isabl creates a [symlink farm](data-model.md) upon data import and analyses completion. You can turn it off with this setting. |
| **DEFAULT\_LINUX\_GROUP** | _String_ | Linux group for data admin\_user to use. |
| **MAKE\_STORAGE\_DIRECTORY** | _Import String_ | Get and create path to a data directory. |
| **TRASH\_ANALYSIS\_STORAGE** | _Import String_ | Move analysis `storage_url` to a trash directory. |
| **REFERENCE\_DATA\_IMPORTER** | _Import String_ | Register input\_bed\_path in technique's storage dir and update data. |
| **DATA\_IMPORTER** | _Import String_ | Import raw data for multiple experiments. |
| **BED\_IMPORTER** | _Import String_ | Register input\_bed\_path in technique's storage dir and update data. |
| **ON\_DATA\_IMPORT** | _Import Strings Array_ | Methods triggered when data has been imported successfully. |
| **ON\_STATUS\_CHANGE** | _Import Strings Array_ | Methods triggered when an analysis changes status. |
| **ON\_SIGNAL\_FAILURE** | _Import Strings Array_ | Methods triggered when an signal fails. |
| **SUBMIT\_ANALYSES** | _Import String_ | A function that will take a list tuples \(analysis, path to analysis script\) and submits them to a given compute architecture.  |
| **SUBMIT\_CONFIGURATION** | Dictionary | A schema-less dictionary to set configurations that the **`SUBMIT_ANALYSES`** function may utilize. |

{% page-ref page="writing-applications.md" %}

## Isabl Web Settings

Customization of the User Interface can be achieved by defining a global `$isabl` settings dictionary in the main `index.html`.

```markup
<script>
    window.$isabl = { }
</script>
```

You can configure the `window.$isabl` with the following parameters:

| Setting Name | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **`apiHost`** | `String` | `''` | Url host where your `isabl api` is running. |
| **`name`** | `String` | `'isabl'` | Custom app title that is shown in the top of the app. |
| **`logo`** | `String` |  | Custom image path that is shown as the main logo of the app. Use a square size image for better display. |
| **`jira`** | `Boolean` | `false` | Activate the jira card in the projects view. If the jira endpoint is available from the api, it will show the current tickets for each project. Learn more about [jira integration](https://developer.atlassian.com/server/jira/platform/rest-apis/). |
| **`oncoTree`** | `Boolean` | `false` | If it's enabled, more information about the [onco tree ](http://oncotree.mskcc.org/#/home)disease is added in the _Sample details_. |
| **`customFields`** | `Object` | `{}` | Every detail info for each model shown in the frontend can be customized, by overwriting the specific key of a fields object. Available fields can be seen [here](https://github.com/isabl-io/web/blob/master/src/utils/fields.js). Learn more on how to create custom fields \(**TODO**\). |
| **`restartButton`** | `Boolean` | `false` | If enabled,`FAILED` analyses can send a signal to restart or force to the database. Learn more in signals \(**TODO**\). |
| **`lightTheme`** | `Object` | See [defaults](https://github.com/isabl-io/web/blob/master/src/utils/settings.js#L8) | Colors to customize the light theme. |
| **`darkTheme`** | `Object` | See [defaults](https://github.com/isabl-io/web/blob/master/src/utils/settings.js#L20) | Colors to customize the dark theme. |
| **`modelIcons`** | `Object` | `{}` | [Material Icon](https://material.io/resources/icons/?style=baseline) names to customize panel icons. |

### Example of a custom UI configuration

```markup
<script>
    const customFields = {
        // overwrite 2 of the fields of the analysis panel
        analysisFields: {
            // Add a new formatter for status
            status: {
                section: 'Analysis Details',
                verboseName: 'Status',
                field: 'status',
                formatter: value => {
                    if (value === 'SUCEEDED') {
                        return 'DONE!'
                    } else if (value === 'FAILED') {
                        return 'OOPS...'
                    } else {
                        return value
                    }
                }
            },
            // Make notes not editable
            notes: {
                section: 'Analysis Details',
                verboseName: 'Notes',
                field: 'notes',
                editable: false
            }
        },
        // display a new custom field for project that exist in the db.
        // Use http://<api-host>/admin/ to create custom fields.
        projectFields: {
            // custom field
            irbConstent: {
              section: 'Project Details',
              verboseName: 'IRB Consent',
              field: 'custom_fields.irb_consent',
              editable: true,
              apiPermission: 'change_project'
            }
          }
        }
    }

    window.$isabl = {
        apiHost: "http://my.isabl.api.host",
        name: "My Cool App",
        logo: "/path/to/my/awesome/logo",
        customFields,
        restartButton: true,
        jira: true,
        oncoTree: true,
        darkTheme: {
          primary: '#1dc5a7',
          background: '#1a202c',
          surface: '#3a4556',
          accent: '#4a5568'
        },
        modelIcons: {
          project: 'insert_chart',
          analysis: 'bubble_chart',
          individual: 'person',
          sample: 'gesture',
          experiment: 'flash_on',
          search: 'search',
          submission: 'assignment'
        },
    }
</script>
```

{% hint style="warning" %}
**Important:** In case you're running your frontend instance in a different host that the backend, you should add this `ENV` variable to your django project where the `isabl-api` is running:

```bash
export FRONTEND_URL="http://your-frontend-host.com"
```
{% endhint %}

{% hint style="success" %}
If you want to consume `isabl-web` and serve your own html, outside of `isabl-api`. You can consume the frontend just as:

```markup
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta charset="UTF-8">
        <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' rel="stylesheet" type="text/css">
        <link rel="icon" href="favicon.ico">
        <title>My Awesome App</title>
    </head>
    <body>

 <div id="isabl-web"></div>
        <script src="https://cdn.jsdelivr.net/npm/vue"></script>
        <script src="https://cdn.jsdelivr.net/npm/isabl-web"></script>
        <script>
            window.$isabl = {
                apiHost: "http://my.isabl.api.host",
                //... other settings
            }
        </script>
    </body>
</html>
```
{% endhint %}

